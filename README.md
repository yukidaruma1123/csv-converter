# CSV統合変換システム

Amazon・楽天・Yahoo のデータをヤマト運輸用CSVに変換するWebアプリケーションです。

## 機能

- **マルチプラットフォーム対応**: Amazon(TSV), 楽天(CSV), Yahoo(CSV)
- **商品マスタ連携**: Excelファイルから重量・色情報を自動取得
- **カラーオモリ対応表**: 楽天・Yahoo商品コードから重量を自動判定
- **住所統合**: 同一配送先の注文を自動的にまとめて処理
- **商品統合**: 同一商品の数量を統合し、色名を省略表示
- **重量別分類**: 1kg以下(A)と1kg超過(Z)で自動分類
- **ECサイト別識別**: ご依頼主名でECサイトを区別
- **ヤマト運輸形式出力**: 送り状システムに直接インポート可能

## 使用方法

1. **商品マスタファイル(Excel形式)を選択** - 必須
2. **ECサイトデータを選択** - Amazon/楽天/Yahoo のうち1つ以上
3. **「データを変換してダウンロード」をクリック**
4. **ヤマト運輸用CSVをダウンロード**

## ファイル形式

### 商品マスタファイル（必須）
- **形式**: Excel(.xlsx/.xlsm)
- **構成**: 
  - A列: 販売サイト
  - B列: 詳細
  - C列: 商品番号
  - D～R列: 重量・個数・色の組み合わせ（複数セット対応）

### ECサイトデータ
- **Amazon**: TSV形式(.txt/.tsv)
- **楽天**: CSV形式(.csv) - SKU情報列対応
- **Yahoo**: CSV形式(.csv) - SubCode/ItemId対応

## 出力仕様

### ヤマト運輸CSV形式
- **送り状種類**: A(1kg以下) / Z(1kg超過)
- **ご依頼主名**: 
  - JGSフィッシュ (Amazon店)
  - JGSフィッシュ (楽天市場店)
  - JGSフィッシュ (yahoo!ｼｮｯﾋﾟﾝｸﾞ店)
- **品名表示**: 25文字以下のみ表示、超過時は空欄
- **重量計算**: 商品マスタ + カラーオモリ対応表による自動計算

### 商品名統合ルール
- **同一商品統合**: 同じ色・重量の商品数量を統合
- **色名省略**: 同じ色の2番目以降は色名を省略
- **重量順ソート**: 各色内で重量の軽い順に表示

例: `銀: 60g×2, 80g×1, 100g×3, 金: 45g×1`

## 技術仕様

- **フロントエンド**: HTML5, CSS3, JavaScript
- **ライブラリ**: 
  - PapaParse 5.4.1 (CSV解析)
  - SheetJS 0.18.5 (Excel読み込み)
- **エンコーディング**: UTF-8/Shift-JIS自動判定
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge(最新版)

## セキュリティ

- **完全クライアントサイド処理**: サーバーにデータは送信されません
- **プライバシー保護**: すべての処理はブラウザ内で完結

## プロジェクト構成

```
csv-converter/
├── README.md
├── index.html
├── カラーオモリ対応表.xlsx
└── manual.pdf
```

## 注意事項

- 元データのバックアップを必ず取ってから変換を実行してください
- 商品マスタの商品番号とECサイトデータの商品コードが一致している必要があります
- カラーオモリ対応表は自動読み込みされます（同じディレクトリに配置）
- 1kg超過の荷物は送り状種類が「Z」となり、CSV下部に配置されます

## バージョン履歴

- **v1.3**: Yahoo複数商品の色統合、商品名省略機能追加
- **v1.2**: カラーオモリ対応表、ECサイト別ご依頼主名対応  
- **v1.1**: 楽天SKU情報、重量別分類機能追加
- **v1.0**: 基本的な変換機能実装
